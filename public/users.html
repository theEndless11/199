<body>
    <!-- Main container -->
    <div class="container">
    
        <!-- Header -->
        <header>
            <h1>Users</h1>
            <input type="text" id="search" class="search-box" placeholder="Search users..." oninput="searchUsers()" />
        </header>

        <!-- Users Section -->
        <section id="users-section">
            <h2>Users</h2>
            <div id="users-container" class="section-content"></div>
        </section>

        <!-- Friends Section -->
        <section id="friends-section">
            <h2>Friends</h2>
            <div id="friends-container" class="section-content"></div>
        </section>

        <!-- X Section (Empty for now, to be modified later) -->
        <section id="x-section">
            <h2>X Section</h2>
            <div id="x-container" class="section-content"></div>
        </section>
        
    </div>

    <script>
        // Get the logged-in user's ID from the query parameter
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('userId');

        // Search users
        let allUsers = [];

        async function fetchUsers() {
            console.log(`Fetching users for userId: ${userId}`); // Debugging
            const response = await fetch(`/api/users?userId=${userId}`);
            const data = await response.json();

            if (response.ok) {
                allUsers = data.users; // Save the original users list for search functionality
                displayUsers(data.users);
            } else {
                console.error('Error fetching users:', data.message);
                alert(data.message);
            }
        }

        // Display users in the Users section
        function displayUsers(users) {
            const usersContainer = document.getElementById('users-container');
            usersContainer.innerHTML = ''; // Clear previous data

            users.forEach(user => {
                const userElement = document.createElement('div');
                userElement.classList.add('user');
                userElement.textContent = user.username;

                // Add "Add to Friends" icon
                const addButton = document.createElement('button');
                addButton.classList.add('add-friend');
                addButton.textContent = 'Add Friend';
                addButton.onclick = () => addFriend(user);

                // Append user element with button to the container
                userElement.appendChild(addButton);
                usersContainer.appendChild(userElement);
            });
        }

        // Function for searching users
        function searchUsers() {
            const searchInput = document.getElementById('search').value.toLowerCase();
            const filteredUsers = allUsers.filter(user => user.username.toLowerCase().includes(searchInput));
            displayUsers(filteredUsers);
        }

        // Placeholder function for adding friends (you can implement it later)
        function addFriend(user) {
            console.log(`Adding ${user.username} to friends...`); // Add friend functionality
        }

        fetchUsers();
    </script>
</body>
